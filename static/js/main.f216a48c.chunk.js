(this["webpackJsonpreact-muji-gallery"]=this["webpackJsonpreact-muji-gallery"]||[]).push([[2],{102:function(e,t,r){},110:function(e,t,r){"use strict";r.r(t);var n,i,o,c,a,s,u=r(0),l=r(26),p=r.n(l),b=(r(102),r(33)),j=r(29),f=r.p+"static/media/logo.eed79801.svg",O=r(42),h=r(30),y=r(111),g=r(77),m=r(76),d=r(5),v=h.a.header(n||(n=Object(j.a)(["\n  display: flex;\n  align-items: center;\n  padding: 0 100px;\n  background-color: #2b2826;\n  color: #c0bfbe;\n"]))),w=h.a.img(i||(i=Object(j.a)(["\n  height: 30px;\n"]))),x=Object(h.a)(O.b)(o||(o=Object(j.a)(["\n  color: #c0bfbe;\n  margin-left: 30px;\n  height: 52px;\n  line-height: 52px;\n  display: inline-block;\n\n  &.active {\n    border-bottom: 4px solid skyblue;\n  }\n"]))),U=h.a.div(c||(c=Object(j.a)(["\n  margin-left: auto;\n"]))),P=Object(h.a)(y.a)(a||(a=Object(j.a)(["\n  margin-left: 24px;\n"]))),k=Object(m.a)((function(){var e=Object(b.f)(),t=Object(g.a)(),r=t.UserStore,n=t.AuthStore;return Object(u.useEffect)((function(){r.pullUser()}),[r]),Object(d.jsxs)(v,{children:[Object(d.jsx)(w,{src:f}),Object(d.jsxs)("nav",{children:[Object(d.jsx)(x,{to:"/",activeClassName:"active",exact:!0,children:"\u9996\u9875"}),Object(d.jsx)(x,{to:"/history",activeClassName:"active",children:"\u4e0a\u4f20\u5386\u53f2"}),Object(d.jsx)(x,{to:"/about",activeClassName:"active",children:"\u5173\u4e8e\u6211"})]}),Object(d.jsx)(U,{children:r.currentUser?Object(d.jsxs)(d.Fragment,{children:[r.currentUser.attributes.username,Object(d.jsx)(P,{type:"primary",onClick:function(){n.logout()},children:"\u6ce8\u9500"})]}):Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(P,{type:"primary",onClick:function(){return e.push("/login")},children:"\u767b\u5f55"}),Object(d.jsx)(P,{type:"primary",onClick:function(){return e.push("/register")},children:"\u6ce8\u518c"})]})})]})})),z=h.a.footer(s||(s=Object(j.a)(["\n  padding: 10px 100px;\n  text-align: center;\n  font-size: 12px;\n  color: #aaa;\n"])));var D=function(){return Object(d.jsx)(z,{children:Object(d.jsx)("p",{children:"Footer"})})};function F(){return Object(d.jsx)("div",{children:"Loading..."})}r(109);var S=Object(u.lazy)((function(){return Promise.all([r.e(0),r.e(1),r.e(6),r.e(11)]).then(r.bind(null,253))})),N=Object(u.lazy)((function(){return r.e(9).then(r.bind(null,246))})),L=Object(u.lazy)((function(){return Promise.all([r.e(0),r.e(5),r.e(10)]).then(r.bind(null,254))})),C=Object(u.lazy)((function(){return Promise.all([r.e(0),r.e(1),r.e(7)]).then(r.bind(null,247))})),q=Object(u.lazy)((function(){return Promise.all([r.e(0),r.e(1),r.e(8)]).then(r.bind(null,248))}));var I=function(){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(k,{}),Object(d.jsx)("main",{children:Object(d.jsx)(u.Suspense,{fallback:Object(d.jsx)(F,{}),children:Object(d.jsxs)(b.c,{children:[Object(d.jsx)(b.a,{path:"/",exact:!0,component:S}),Object(d.jsx)(b.a,{path:"/history",component:L}),Object(d.jsx)(b.a,{path:"/about",component:N}),Object(d.jsx)(b.a,{path:"/login",component:C}),Object(d.jsx)(b.a,{path:"/register",component:q})]})})}),Object(d.jsx)(D,{})]})};p.a.render(Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(O.a,{children:Object(d.jsx)(I,{})})}),document.getElementById("root"))},77:function(e,t,r){"use strict";var n=r(19),i=r(31),o=r(32),c=r(8),a=(r(55),r(3)),s=r(25),u=r.n(s);u.a.init({appId:"9JBQ1SKD20ljqcJtOBbzan57-gzGzoHsz",appKey:"jzuqL3dTJvWP6rqWxQTyP6v5",serverURL:"https://9jbq1skd.lc-cn-n1-shared.com"});var l,p,b,j,f,O,h,y,g,m,d,v,w,x,U,P=function(e,t){var r=new s.User;return r.setUsername(e),r.setPassword(t),new Promise((function(e,t){r.signUp().then((function(t){return e(t)}),(function(e){return t(e)}))}))},k=function(e,t){return new Promise((function(r,n){s.User.logIn(e,t).then((function(e){return r(e)}),(function(e){return n(e)}))}))},z=function(){return s.User.logOut()},D=function(){return s.User.current()},F=function(e,t){var r=new u.a.Object("image"),n=new u.a.File(e,t);return r.set("filefile",e),r.set("owner",u.a.User.current()),r.set("url",n),new Promise((function(e,t){r.save().then((function(t){return e(t)}),(function(e){return t(e)}))}))},S=function(e){var t=e.page,r=void 0===t?0:t,n=e.limit,i=void 0===n?10:n,o=new u.a.Query("image");return o.include("owner"),o.limit(i),o.skip(r*i),o.descending("createdAt"),o.equalTo("owner",u.a.User.current()),new Promise((function(e,t){o.find().then((function(t){return e(t)})).catch((function(e){return t(e)}))}))},N=function(e){var t=u.a.Object.createWithoutData("image",e);return new Promise((function(e,r){t.destroy().then((function(t){return e(t)})).catch((function(e){return r(e)}))}))},L=new(l=function(){function e(){Object(i.a)(this,e),Object(n.a)(this,"currentUser",p,this),Object(a.m)(this)}return Object(o.a)(e,[{key:"pullUser",value:function(){this.currentUser=D()}},{key:"resetUser",value:function(){this.currentUser=null}}]),e}(),p=Object(c.a)(l.prototype,"currentUser",[a.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(c.a)(l.prototype,"pullUser",[a.f],Object.getOwnPropertyDescriptor(l.prototype,"pullUser"),l.prototype),Object(c.a)(l.prototype,"resetUser",[a.f],Object.getOwnPropertyDescriptor(l.prototype,"resetUser"),l.prototype),l),C=r(97),q=new(b=function(){function e(){Object(i.a)(this,e),Object(n.a)(this,"list",j,this),Object(n.a)(this,"page",f,this),Object(n.a)(this,"limit",O,this),Object(n.a)(this,"isLoading",h,this),Object(n.a)(this,"hasMore",y,this),Object(a.m)(this)}return Object(o.a)(e,[{key:"append",value:function(e){this.list=e.concat(this.list)}},{key:"pullList",value:function(){var e=this;S({page:this.page,limit:this.limit}).then((function(t){e.page++,e.append(t),e.hasMore=!1})).catch((function(e){return C.b.error("\u52a0\u8f7d\u6570\u636e\u5931\u8d25")}))}},{key:"remove",value:function(e){var t=this;N(e).then((function(){t.reset(),console.log("\u5220\u9664\u6210\u529f")})).catch((function(e){return C.b.error("\u5220\u9664\u6570\u636e\u5931\u8d25")}))}},{key:"reset",value:function(){this.list=[],this.page=0,this.limit=10,this.isLoading=!1,this.hasMore=!0}}]),e}(),j=Object(c.a)(b.prototype,"list",[a.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=Object(c.a)(b.prototype,"page",[a.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),O=Object(c.a)(b.prototype,"limit",[a.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),h=Object(c.a)(b.prototype,"isLoading",[a.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=Object(c.a)(b.prototype,"hasMore",[a.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Object(c.a)(b.prototype,"append",[a.f],Object.getOwnPropertyDescriptor(b.prototype,"append"),b.prototype),Object(c.a)(b.prototype,"pullList",[a.f],Object.getOwnPropertyDescriptor(b.prototype,"pullList"),b.prototype),Object(c.a)(b.prototype,"remove",[a.f],Object.getOwnPropertyDescriptor(b.prototype,"remove"),b.prototype),Object(c.a)(b.prototype,"reset",[a.f],Object.getOwnPropertyDescriptor(b.prototype,"reset"),b.prototype),b),I=new(g=function(){function e(){Object(i.a)(this,e),Object(n.a)(this,"fileName",m,this),Object(n.a)(this,"file",d,this),Object(n.a)(this,"isUploading",v,this),Object(n.a)(this,"serverFile",w,this),Object(a.m)(this)}return Object(o.a)(e,[{key:"setFileName",value:function(e){this.fileName=e}},{key:"setFile",value:function(e){this.file=e}},{key:"upload",value:function(){var e=this;return this.isUploading=!0,new Promise((function(t,r){return F(e.fileName,e.file).then((function(r){e.serverFile=r,t(r)})).catch((function(e){C.b.error("\u4e0a\u4f20\u5931\u8d25"),r(e)})).finally((function(){return e.isUploading=!1}))}))}},{key:"reset",value:function(){this.isUploading=!1,this.serverFile=null}}]),e}(),m=Object(c.a)(g.prototype,"fileName",[a.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),d=Object(c.a)(g.prototype,"file",[a.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=Object(c.a)(g.prototype,"isUploading",[a.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w=Object(c.a)(g.prototype,"serverFile",[a.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(c.a)(g.prototype,"setFileName",[a.f],Object.getOwnPropertyDescriptor(g.prototype,"setFileName"),g.prototype),Object(c.a)(g.prototype,"setFile",[a.f],Object.getOwnPropertyDescriptor(g.prototype,"setFile"),g.prototype),Object(c.a)(g.prototype,"upload",[a.f],Object.getOwnPropertyDescriptor(g.prototype,"upload"),g.prototype),Object(c.a)(g.prototype,"reset",[a.f],Object.getOwnPropertyDescriptor(g.prototype,"reset"),g.prototype),g),J=new(x=function(){function e(){Object(i.a)(this,e),Object(n.a)(this,"values",U,this),Object(a.m)(this)}return Object(o.a)(e,[{key:"setUsername",value:function(e){this.values.username=e}},{key:"setPassword",value:function(e){this.values.password=e}},{key:"login",value:function(){var e=this;return new Promise((function(t,r){k(e.values.username,e.values.password).then((function(e){L.pullUser(),t(e)})).catch((function(e){L.resetUser(),C.b.error("\u767b\u9646\u5931\u8d25"),r(e)}))}))}},{key:"register",value:function(){var e=this;return new Promise((function(t,r){P(e.values.username,e.values.password).then((function(e){L.pullUser(),console.log("\u6ce8\u518c\u6210\u529f"),t(e)})).catch((function(e){console.log(typeof e.valueOf(),e.toString()),"Error: Username has already been taken. [400 POST https://9jbq1skd.lc-cn-n1-shared.com/1.1/users]"===e.toString()?C.b.error("\u8be5\u7528\u6237\u540d\u5df2\u88ab\u6ce8\u518c,\u8bf7\u91cd\u8bd5"):C.b.error("\u6ce8\u518c\u5931\u8d25"),L.resetUser(),r(e)}))}))}},{key:"logout",value:function(){return L.resetUser(),q.reset(),I.reset(),z()}}]),e}(),U=Object(c.a)(x.prototype,"values",[a.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{username:"",password:""}}}),Object(c.a)(x.prototype,"setUsername",[a.f],Object.getOwnPropertyDescriptor(x.prototype,"setUsername"),x.prototype),Object(c.a)(x.prototype,"setPassword",[a.f],Object.getOwnPropertyDescriptor(x.prototype,"setPassword"),x.prototype),Object(c.a)(x.prototype,"login",[a.f],Object.getOwnPropertyDescriptor(x.prototype,"login"),x.prototype),Object(c.a)(x.prototype,"register",[a.f],Object.getOwnPropertyDescriptor(x.prototype,"register"),x.prototype),Object(c.a)(x.prototype,"logout",[a.f],Object.getOwnPropertyDescriptor(x.prototype,"logout"),x.prototype),x),M=r(0),T=Object(M.createContext)({AuthStore:J,UserStore:L,ImageStore:I,HistoryStore:q});window.x={ImageStore:I,UserStore:L,HistoryStore:q};t.a=function(){return Object(M.useContext)(T)}}},[[110,3,4]]]);
//# sourceMappingURL=main.f216a48c.chunk.js.map