{"version":3,"sources":["components/Uploader.js","components/Tips.js","view/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","DraggerWrapper","FormStyle","Form","Component","observer","useStore","ImageStore","UserStore","props","showUploadList","beforeUpload","file","serverFile","currentUser","test","type","size","message","error","setFile","setFileName","name","upload","then","console","log","catch","warning","ref1","useRef","ref2","store","useLocalStore","width","height","attributes","url","widthStr","heightStr","setWidth","setHeight","validatorUsername","rule","value","Promise","resolve","reject","spinning","isUploading","className","InboxOutlined","fileName","src","alt","Item","rules","validator","style","marginRight","ref","onChange","e","target","placeholder","rel","href","fullStr","Tips","children","Home","Uploader"],"mappings":"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","file":"static/js/11.86afef53.chunk.js","sourcesContent":["import React, {useRef} from 'react'\r\nimport useStore from '../stores'\r\nimport {Upload, message, Spin, Input, Form} from 'antd'\r\nimport {InboxOutlined} from '@ant-design/icons'\r\nimport {observer, useLocalStore} from 'mobx-react'\r\nimport styled from 'styled-components'\r\n\r\nconst {Dragger} = Upload\r\nconst Result = styled.div`\r\n  margin-top: 30px;\r\n  border: 1px solid #ccc;\r\n  padding: 20px;\r\n  background: rgba(255, 255, 255, 0.5);\r\n  border-radius: 4px;\r\n\r\n`\r\nconst H1 = styled.h1`\r\n  text-align: center;\r\n`\r\nconst Image = styled.img`\r\n  max-width: 300px;\r\n`\r\nconst DraggerWrapper = styled(Dragger)`\r\n  background: rgba(0, 0, 0, 0.4) !important;\r\n  border: 1px solid !important;\r\n  box-shadow: 0 5px 5px -3px rgb(0 0 0 / 20%), 0 8px 10px 1px rgb(0 0 0 / 14%), 0 3px 14px 2px rgb(0 0 0 / 12%);\r\n\r\n  .ant-upload-text {\r\n    color: #fff !important;\r\n  }\r\n\r\n  .ant-upload-hint {\r\n    color: #ccc !important;\r\n  }\r\n`\r\nconst FormStyle = styled(Form)`\r\n  height: 40px;\r\n\r\n  > div {\r\n    display: inline-block;\r\n  }\r\n`\r\n\r\nconst Component = observer(() => {\r\n  const {ImageStore, UserStore} = useStore()\r\n  const props = {\r\n    showUploadList: false,     // 不显示文件列表\r\n    beforeUpload: file => {\r\n      ImageStore.serverFile = null\r\n      if (!UserStore.currentUser) {\r\n        message.warning('请先登录 !')\r\n        return false\r\n      }\r\n      if (!/(gif$)| (jeg$)|(png$)|(jpeg$)/ig.test(file.type)) {\r\n        message.error('只支持上传 jpg/jpeg/png/gif 格式的图片')\r\n        return false\r\n      }\r\n      if (file.size > 1024 * 1024) {\r\n        message.error('图片最大为 1M')\r\n        return false\r\n      }\r\n      ImageStore.setFile(file)\r\n      ImageStore.setFileName(file.name)\r\n      ImageStore.upload()\r\n        .then((serverFile) => console.log(serverFile))\r\n        .catch(error => console.log('上传失败：' + error))\r\n      return false\r\n    }\r\n  }\r\n  const ref1 = useRef()\r\n  const ref2 = useRef()\r\n  const store = useLocalStore(() => ({\r\n    width: null,\r\n    height: null,\r\n    get widthStr() {\r\n      return store.width ? `/w/${store.width}` : ''\r\n    },\r\n    get heightStr() {\r\n      return store.height ? `/h/${store.height}` : ''\r\n    },\r\n    get fullStr() {\r\n      //?imageView2/0/w/800/h/400)\r\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\r\n    },\r\n    setWidth(width) {\r\n      store.width = width\r\n    },\r\n    setHeight(height) {\r\n      store.height = height\r\n    },\r\n  }))\r\n\r\n  function bindWidthChange(e) {\r\n    store.setWidth(e.target.value)\r\n  }\r\n\r\n  function bindHeightChange(e) {\r\n    store.setHeight(e.target.value)\r\n  }\r\n\r\n  const validatorUsername = (rule, value) => {\r\n    if (!/^[0-9]*$/.test(value)) {return Promise.reject('只能是数字')}\r\n    return Promise.resolve()\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Spin spinning={ImageStore.isUploading}>\r\n        <DraggerWrapper {...props}>\r\n          <p className=\"ant-upload-drag-icon\">\r\n            <InboxOutlined/>\r\n          </p>\r\n          <p className=\"ant-upload-text\">单击或拖动文件到此区域以上传</p>\r\n          <p className=\"ant-upload-hint\">\r\n            支持jpg/jpeg/png/gif 格式的图片,可单次或批量上传。\r\n          </p>\r\n        </DraggerWrapper>\r\n      </Spin>\r\n\r\n      {ImageStore.serverFile ?\r\n        <Result>\r\n          <H1>上传结果</H1>\r\n          <dl>\r\n            <dt><h2>文件名：</h2></dt>\r\n            <dd>{ImageStore.fileName}</dd>\r\n            <dt><h2>图片预览：</h2></dt>\r\n            <dd><Image src={ImageStore.serverFile.attributes.url.attributes.url} alt=\"\"/></dd>\r\n            <dt><h2>尺寸修改：</h2></dt>\r\n            <dd>\r\n              <FormStyle name=\"basic\">\r\n                <Form.Item name=\"width\"\r\n                           rules={[{validator: validatorUsername}]}>\r\n                  <Input style={{width: '200px', marginRight: '16px'}} ref={ref1} onChange={bindWidthChange}\r\n                         placeholder=\"最大宽度（可选）\"/>\r\n                </Form.Item>\r\n                <Form.Item name=\"height\"\r\n                           rules={[{validator: validatorUsername}]}>\r\n                  <Input style={{width: '200px'}} ref={ref2} onChange={bindHeightChange} placeholder=\"最大高度（可选）\"/>\r\n                </Form.Item>\r\n              </FormStyle>\r\n            </dd>\r\n            <dt><h2>保存地址：</h2></dt>\r\n            <dd>\r\n              <a target=\"_blank\" rel=\"noopener noreferrer\"\r\n                 href={store.fullStr}>\r\n                {store.fullStr}\r\n              </a>\r\n            </dd>\r\n          </dl>\r\n        </Result> : null\r\n      }\r\n\r\n    </>\r\n  )\r\n})\r\nexport default Component\r\n","import React from 'react'\r\nimport useStore from '../stores'\r\nimport {observer} from 'mobx-react'\r\nimport styled from 'styled-components'\r\n\r\nconst Tips = styled.div`\r\n  background: rgba(252, 0, 0, 0.5);\r\n  padding: 10px;\r\n  margin: 30px 0;\r\n  color: white;\r\n  border-radius: 4px;\r\n  font-weight: bold;\r\n`\r\n\r\nconst Component = observer(({children}) => {\r\n  const {UserStore} = useStore()\r\n  return (\r\n    <>{\r\n      UserStore.currentUser ? null : <Tips>{children}</Tips>\r\n    }</>\r\n  )\r\n})\r\nexport default Component\r\n","import React from 'react'\r\nimport Uploader from '../components/Uploader'\r\nimport Tips from '../components/Tips'\r\n\r\nfunction Home() {\r\n  return (\r\n    <>\r\n      <Tips>请登陆后使用</Tips>\r\n      <Uploader/>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Home\r\n"],"sourceRoot":""}